<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  BIOS/UEFI and other Firmware Updates
  #

LSUClient will install BIOS/UEFI updates silently when possible.
Like with any other package, those for which a silent installation is supported will have their
.Installer.Unattended property set to $True. If you get a BIOS/UEFI update for which
.Installer.Unattended is $False, that means it uses a type of installer/flasher for which
either no silent install options exist or for which LSUClient doesn&rsquo;t support performing silent installs yet."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://jantari.github.io/LSUClient-docs/docs/topics/bios-and-firmware/"><meta property="og:site_name" content="LSUClient Documentation"><meta property="og:title" content="BIOS/UEFI and Firmware Updates"><meta property="og:description" content="BIOS/UEFI and other Firmware Updates # LSUClient will install BIOS/UEFI updates silently when possible.
Like with any other package, those for which a silent installation is supported will have their .Installer.Unattended property set to $True. If you get a BIOS/UEFI update for which .Installer.Unattended is $False, that means it uses a type of installer/flasher for which either no silent install options exist or for which LSUClient doesnâ€™t support performing silent installs yet."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><title>BIOS/UEFI and Firmware Updates | LSUClient Documentation</title><link rel=icon href=/LSUClient-docs/favicon.png><link rel=manifest href=/LSUClient-docs/manifest.json><link rel=canonical href=https://jantari.github.io/LSUClient-docs/docs/topics/bios-and-firmware/><link rel=stylesheet href=/LSUClient-docs/book.min.cf92016a77c807cf72d3d29fc3377c31f62a614302f7e528addc53bec495cb04.css integrity="sha256-z5IBanfIB89y09Kfwzd8MfYqYUMC9+UordxTvsSVywQ=" crossorigin=anonymous><script defer src=/LSUClient-docs/fuse.min.js></script><script defer src=/LSUClient-docs/en.search.min.c02c1d3bfc0fc0ace8fb56c09f4a49e41577a896c7fb79c8eb3761e0a889cb21.js integrity="sha256-wCwdO/wPwKzo+1bAn0pJ5BV3qJbH+3nI6zdh4KiJyyE=" crossorigin=anonymous></script><link rel=stylesheet type=text/css href=/LSUClient-docs/nord.css><link rel=stylesheet type=text/css href=/LSUClient-docs/syntax.css><link rel=stylesheet type=text/css href=/LSUClient-docs/fontawesome/css/fontawesome.css><link rel=stylesheet type=text/css href=/LSUClient-docs/fontawesome/css/brands.css><link rel=stylesheet type=text/css href=/LSUClient-docs/fontawesome/css/solid.css></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/LSUClient-docs/><span>LSUClient Documentation</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li class=book-section-flat><span>Topics</span><ul><li><a href=/LSUClient-docs/docs/topics/examples/>Getting Started</a></li><li><a href=/LSUClient-docs/docs/topics/best-practices/>Best Practices</a></li><li><a href=/LSUClient-docs/docs/topics/bios-and-firmware/ class=active>BIOS/UEFI and Firmware Updates</a></li><li><a href=/LSUClient-docs/docs/topics/hanging-processes/>Troubleshooting Hanging Processes</a></li><li><a href=/LSUClient-docs/docs/topics/self-hosted-repositories/>Self-Hosted Repositories</a></li><li><a href=/LSUClient-docs/docs/topics/versioning/>Versioning</a></li></ul></li><li class=book-section-flat><span>Cmdlet Reference</span><ul><li><a href=/LSUClient-docs/docs/cmdlets/expand-lsupdate/>Expand-LSUpdate</a></li><li><a href=/LSUClient-docs/docs/cmdlets/get-lsuclientconfiguration/>Get-LSUClientConfiguration</a></li><li><a href=/LSUClient-docs/docs/cmdlets/get-lsupdate/>Get-LSUpdate</a></li><li><a href=/LSUClient-docs/docs/cmdlets/install-lsupdate/>Install-LSUpdate</a></li><li><a href=/LSUClient-docs/docs/cmdlets/save-lsupdate/>Save-LSUpdate</a></li><li><a href=/LSUClient-docs/docs/cmdlets/set-lsuclientconfiguration/>Set-LSUClientConfiguration</a></li></ul></li><li class=book-section-flat><span>Links</span><ul></ul></li></ul><ul><li><a href target=_blank rel=noopener></a></li></ul><ul><li class=beat-on-hover><a href=https://github.com/jantari/LSUClient target=_blank rel=noopener><i class="fa-brands fa-github"></i>
GitHub</a></li><li class=beat-on-hover><a href=https://github.com/jantari/LSUClient/releases target=_blank rel=noopener><i class="fa-solid fa-list-ul"></i>
Release Notes</a></li><li class=beat-on-hover><a href=https://www.powershellgallery.com/packages/LSUClient/ target=_blank rel=noopener><i class="fa-solid fa-terminal"></i>
PowerShell Gallery</a></li><li class=beat-on-hover><a href=https://github.com/alex-shpak/hugo-book target=_blank rel=noopener><i class="fa-solid fa-paint-roller"></i>
Hugo Book Theme</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/LSUClient-docs/svg/menu.svg class=book-icon alt=Menu></label><h3>BIOS/UEFI and Firmware Updates</h3><label for=toc-control><img src=/LSUClient-docs/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#handling-reboots>Handling reboots</a></li><li><a href=#savebiosupdateinfotoregistry-parameter>SaveBIOSUpdateInfoToRegistry Parameter</a></li><li><a href=#excluding-bios-andor-firmware-updates>Excluding BIOS and/or firmware updates</a></li><li><a href=#recommended-reading>Recommended reading</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=biosuefi-and-other-firmware-updates>BIOS/UEFI and other Firmware Updates
<a class=anchor href=#biosuefi-and-other-firmware-updates>#</a></h1><p>LSUClient will install BIOS/UEFI updates silently when possible.</p><p>Like with any other package, those for which a silent installation is supported will have their
<code>.Installer.Unattended</code> property set to <code>$True</code>. If you get a BIOS/UEFI update for which
<code>.Installer.Unattended</code> is <code>$False</code>, that means it uses a type of installer/flasher for which
either no silent install options exist or for which LSUClient doesn&rsquo;t support performing silent installs yet.</p><p>When you install such a non-silent package its setup routine will be invoked with the default arguments in the same way System Update would.<br>Likely this will mean a graphical wizard will come up and wait for you to confirm or cancel the update.</p><h2 id=handling-reboots>Handling reboots
<a class=anchor href=#handling-reboots>#</a></h2><p>It is important to know that some Lenovo computers require a reboot to apply BIOS updates
while other models require a shutdown - the BIOS will then wake the machine from the power-off state,
apply the update and boot back into Windows. Other, non-BIOS firmware updates typically always require a reboot.
So as to not interrupt a deployment or someone working, this module will never initiate reboots
or shutdowns on its own, however it&rsquo;s easy for you to:</p><ol><li><p>Capture the <code>PackageInstallResult</code> objects returned by <code>Install-LSUpdate</code>, e.g.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=p>[</span><span class=no>array</span><span class=p>]</span><span class=nv>$results</span> <span class=p>=</span> <span class=nb>Install-LSUpdate</span> <span class=n>-Package</span> <span class=nv>$updates</span>
</span></span></code></pre></div></li><li><p>Then test for the <code>PendingAction</code> values <code>REBOOT_MANDATORY</code> and <code>SHUTDOWN</code> and handle them in your script:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$results</span><span class=p>.</span><span class=py>PendingAction</span> <span class=o>-contains</span> <span class=s1>&#39;REBOOT_MANDATORY&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c># reboot immediately or set a marker for yourself to perform the reboot shortly</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$results</span><span class=p>.</span><span class=py>PendingAction</span> <span class=o>-contains</span> <span class=s1>&#39;SHUTDOWN&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c># shutdown immediately or set a marker for yourself to perform the shutdown shortly</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>If you prefer to loop through the updates one-by-one and handle their result immediately, you can use <code>-eq</code> or a switch statement:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=k>foreach</span> <span class=p>(</span><span class=nv>$update</span> <span class=k>in</span> <span class=nv>$updates</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$result</span> <span class=p>=</span> <span class=nb>Install-LSUpdate</span> <span class=n>-Package</span> <span class=nv>$update</span>
</span></span><span class=line><span class=cl>    <span class=k>switch</span> <span class=p>(</span><span class=nv>$result</span><span class=p>.</span><span class=n>PendingAction</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;REBOOT_MANDATORY&#39;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c># reboot immediately or set a marker for yourself to perform the reboot shortly</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;SHUTDOWN&#39;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c># shutdown immediately or set a marker for yourself to perform the shutdown shortly</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></li></ol><h2 id=savebiosupdateinfotoregistry-parameter>SaveBIOSUpdateInfoToRegistry Parameter
<a class=anchor href=#savebiosupdateinfotoregistry-parameter>#</a></h2><blockquote class="book-hint danger">This parameter is deprecated and only documented for the sake of helping move existing scripts away from it.
It may be removed in a future major release of LSUClient. Use the technique described [above](#handling-reboots) instead.</blockquote><p>There is also a <code>-SaveBIOSUpdateInfoToRegistry</code> parameter on <code>Install-LSUpdate</code>.</p><p>Prior to version 1.4.0, this used to be the only way for LSUClient to communicate a required power cycle back to you.</p><p>When <code>Install-LSUpdate</code> is called with this parameter and it successfully installs a BIOS update,
it will write some registry keys to <code>HKLM\Software\LSUClient\BIOSUpdate</code>, including the string
<code>ActionNeeded</code> which will contain either <code>"REBOOT"</code> or <code>"SHUTDOWN"</code>.</p><p>However, using the <code>-SaveBIOSUpdateInfoToRegistry</code> parameter is no longer recommended because,
as the name implies, it only sets those registry keys when installing BIOS/UEFI updates and not
for any other kinds of firmware updates that might require a reboot just the same.</p><p>To summarize the differences and aid the transition, the following table compares the values
to expect in different scenarios:</p><table><thead><tr><th style=text-align:left>Scenario</th><th style=text-align:left>PendingAction property</th><th>&ldquo;ActionNeeded&rdquo; registry value set by <code>-SaveBIOSUpdateInfoToRegistry</code></th></tr></thead><tbody><tr><td style=text-align:left>ThinkPad BIOS update</td><td style=text-align:left>REBOOT_MANDATORY</td><td>REBOOT</td></tr><tr><td style=text-align:left>ThinkCentre BIOS update</td><td style=text-align:left>SHUTDOWN</td><td>SHUTDOWN</td></tr><tr><td style=text-align:left>Any Reboot Type 5 update</td><td style=text-align:left>REBOOT_MANDATORY</td><td></td></tr><tr><td style=text-align:left>Any Reboot Type 3 update</td><td style=text-align:left>REBOOT_SUGGESTED</td><td></td></tr><tr><td style=text-align:left>Any Reboot Type 0 update</td><td style=text-align:left>NONE</td><td></td></tr><tr><td style=text-align:left>Any unsuccessful update</td><td style=text-align:left>NONE</td><td></td></tr></tbody></table><p>As you can see, the <code>PendingAction</code> property is always set and more explicit and granular in communicating whether a power cycle is needed or not.</p><h2 id=excluding-bios-andor-firmware-updates>Excluding BIOS and/or firmware updates
<a class=anchor href=#excluding-bios-andor-firmware-updates>#</a></h2><p>If you want to simply not install any BIOS/UEFI updates, I recommend filtering them by <code>Type</code> and possibly <code>Category</code> and <code>Title</code> as a fallback.</p><blockquote class="book-hint warning">Not all packages have type information, sometimes `Type` is `$null` so don't rely on this property alone</blockquote><blockquote class="book-hint warning">Packages sourced from internal repositories created with "Lenovo Update Retriever" never have `Category` information.
In that scenario it is best to either not have BIOS updates in your repository at all, make sure
they always have their `Type` set correctly or to filter them by their IDs before installing.</blockquote><p>Filtering out BIOS/UEFI updates:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$updates</span> <span class=p>=</span> <span class=nb>Get-LSUpdate</span> <span class=p>|</span>
</span></span><span class=line><span class=cl>    <span class=nb>Where-Object</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=nb>Type </span><span class=o>-ne</span> <span class=s1>&#39;BIOS&#39;</span> <span class=p>}</span> <span class=p>|</span>
</span></span><span class=line><span class=cl>    <span class=nb>Where-Object</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>Category</span> <span class=o>-notmatch</span> <span class=s2>&#34;BIOS|UEFI&#34;</span> <span class=p>}</span> <span class=p>|</span>
</span></span><span class=line><span class=cl>    <span class=nb>Where-Object</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>Title</span> <span class=o>-notmatch</span> <span class=s2>&#34;BIOS|UEFI&#34;</span> <span class=p>}</span>
</span></span></code></pre></div><p>Filtering out other firmware updates:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$updates</span> <span class=p>=</span> <span class=nb>Get-LSUpdate</span> <span class=p>|</span>
</span></span><span class=line><span class=cl>    <span class=nb>Where-Object</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=nb>Type </span><span class=o>-ne</span> <span class=s1>&#39;Firmware&#39;</span> <span class=p>}</span> <span class=p>|</span>
</span></span><span class=line><span class=cl>    <span class=nb>Where-Object</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>RebootType</span> <span class=o>-ne</span> <span class=mf>5</span> <span class=p>}</span> <span class=p>|</span>
</span></span><span class=line><span class=cl>    <span class=nb>Where-Object</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>Category</span> <span class=o>-notlike</span> <span class=s2>&#34;*Firmware*&#34;</span> <span class=p>}</span> <span class=p>|</span>
</span></span><span class=line><span class=cl>    <span class=nb>Where-Object</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>Title</span> <span class=o>-notlike</span> <span class=s2>&#34;*Firmware*&#34;</span> <span class=p>}</span>
</span></span></code></pre></div><h2 id=recommended-reading>Recommended reading
<a class=anchor href=#recommended-reading>#</a></h2><p><a href=https://support.lenovo.com/de/en/solutions/ht507859-bios-flashing-sccm-support-thinkcentre-thinkstation>https://support.lenovo.com/de/en/solutions/ht507859-bios-flashing-sccm-support-thinkcentre-thinkstation</a><br><a href=https://thinkdeploy.blogspot.com/2019/06/what-are-reboot-delayed-updates.html>https://thinkdeploy.blogspot.com/2019/06/what-are-reboot-delayed-updates.html</a></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#handling-reboots>Handling reboots</a></li><li><a href=#savebiosupdateinfotoregistry-parameter>SaveBIOSUpdateInfoToRegistry Parameter</a></li><li><a href=#excluding-bios-andor-firmware-updates>Excluding BIOS and/or firmware updates</a></li><li><a href=#recommended-reading>Recommended reading</a></li></ul></nav></div></aside></main></body></html>