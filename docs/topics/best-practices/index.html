<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Best Practices # 1. Search for and install updates a few times in a loop # Some packages and updates depend on others already being installed, so they might not show up during the first search for updates. If you want to make sure &ldquo;everything&rdquo; has been installed and/or updated it is best to re-run Get-LSUpdate and Install-LSUpdate a few times or until no more updates are found.
Example This is a minimal example implementation of this best practice for demonstration purposes:"><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content><meta property="og:description" content="Best Practices # 1. Search for and install updates a few times in a loop # Some packages and updates depend on others already being installed, so they might not show up during the first search for updates. If you want to make sure &ldquo;everything&rdquo; has been installed and/or updated it is best to re-run Get-LSUpdate and Install-LSUpdate a few times or until no more updates are found.
Example This is a minimal example implementation of this best practice for demonstration purposes:"><meta property="og:type" content="article"><meta property="og:url" content="https://jantari.github.io/LSUClient-docs/docs/topics/best-practices/"><meta property="article:section" content="docs"><title>Best Practices | LSUClient Documentation</title><link rel=manifest href=/LSUClient-docs/manifest.json><link rel=icon href=/LSUClient-docs/favicon.png type=image/x-icon><link rel=stylesheet href=/LSUClient-docs/book.min.c88b93b9ecb16d5abb0111a0a8bdc0745499151283aee71eb7ddec30fd96d239.css integrity="sha256-yIuTueyxbVq7ARGgqL3AdFSZFRKDrucet93sMP2W0jk=" crossorigin=anonymous><script defer src=/LSUClient-docs/flexsearch.min.js></script>
<script defer src=/LSUClient-docs/en.search.min.f4381843c2be00c1a991d7fb7604b04a5de6176c133127e67e02825e869d5d8d.js integrity="sha256-9DgYQ8K+AMGpkdf7dgSwSl3mF2wTMSfmfgKCXoadXY0=" crossorigin=anonymous></script>
<link rel=stylesheet type=text/css href=/LSUClient-docs/nord.css><link rel=stylesheet type=text/css href=/LSUClient-docs/syntax.css></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/LSUClient-docs/><span>LSUClient Documentation</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><span>Topics</span><ul><li><a href=/LSUClient-docs/docs/topics/examples/>Basic Examples</a></li><li><a href=/LSUClient-docs/docs/topics/best-practices/ class=active>Best Practices</a></li><li><a href=/LSUClient-docs/docs/topics/bios-and-firmware/>BIOS/UEFI and Firmware updates</a></li><li><a href=/LSUClient-docs/docs/topics/hanging-processes/>Troubleshooting Hanging Processes</a></li><li><a href=/LSUClient-docs/docs/topics/self-hosted-repositories/>Self-hosted repositories</a></li><li><a href=/LSUClient-docs/docs/topics/versioning/>Versioning</a></li></ul></li><li class=book-section-flat><span>Cmdlet Reference</span><ul><li><a href=/LSUClient-docs/docs/cmdlets/get-lsuclientconfiguration/>Get-LSUClientConfiguration</a></li><li><a href=/LSUClient-docs/docs/cmdlets/get-lsupdate/>Get-LSUpdate</a></li><li><a href=/LSUClient-docs/docs/cmdlets/install-lsupdate/>Install-LSUpdate</a></li><li><a href=/LSUClient-docs/docs/cmdlets/save-lsupdate/>Save-LSUpdate</a></li><li><a href=/LSUClient-docs/docs/cmdlets/set-lsuclientconfiguration/>Set-LSUClientConfiguration</a></li></ul></li></ul><ul><li><a href=https://github.com/jantari/LSUClient target=_blank rel=noopener>ðŸ”— GitHub</a></li><li><a href=https://github.com/jantari/LSUClient/releases target=_blank rel=noopener>ðŸ”— Release Notes</a></li><li><a href=https://www.powershellgallery.com/packages/LSUClient/ target=_blank rel=noopener>ðŸ”— PowerShell Gallery</a></li><li><a href=https://github.com/alex-shpak/hugo-book target=_blank rel=noopener>ðŸ”— Hugo Book Theme</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/LSUClient-docs/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Best Practices</strong>
<label for=toc-control><img src=/LSUClient-docs/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#1-search-for-and-install-updates-a-few-times-in-a-loop>1. Search for and install updates a few times in a loop</a></li><li><a href=#2-download-all-packages-before-starting-to-install-any>2. Download all packages before starting to install any</a></li><li><a href=#3-write-a-logfile>3. Write a logfile</a></li></ul></nav></aside></header><article class=markdown><h1 id=best-practices>Best Practices
<a class=anchor href=#best-practices>#</a></h1><h2 id=1-search-for-and-install-updates-a-few-times-in-a-loop>1. Search for and install updates a few times in a loop
<a class=anchor href=#1-search-for-and-install-updates-a-few-times-in-a-loop>#</a></h2><p>Some packages and updates depend on others already being installed, so they might not show up during the first search for updates.
If you want to make sure &ldquo;everything&rdquo; has been installed and/or updated it is best to re-run
<code>Get-LSUpdate</code> and <code>Install-LSUpdate</code> a few times or until no more updates are found.</p><details><summary>Example</summary><div class=markdown-inner><p>This is a minimal example implementation of this best practice for demonstration purposes:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$MaxRounds</span> <span class=p>=</span> <span class=n>3</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=nv>$Round</span> <span class=p>=</span> <span class=n>1</span><span class=p>;</span> <span class=nv>$Round</span> <span class=o>-le</span> <span class=nv>$MaxRounds</span><span class=p>;</span> <span class=nv>$Round</span><span class=p>++)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>Write-Host</span> <span class=s2>&#34;Starting round $Round&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$updates</span> <span class=p>=</span> <span class=nb>Get-LSUpdate</span>
</span></span><span class=line><span class=cl>    <span class=nb>Write-Host</span> <span class=s2>&#34;</span><span class=p>$(</span><span class=nv>$updates</span><span class=p>.</span><span class=n>Count</span><span class=p>)</span><span class=s2> updates found&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$updates</span><span class=p>.</span><span class=n>Count</span> <span class=o>-eq</span> <span class=n>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$updates</span> <span class=p>|</span> <span class=nb>Install-LSUpdate</span> <span class=n>-Verbose</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></div></details><h2 id=2-download-all-packages-before-starting-to-install-any>2. Download all packages before starting to install any
<a class=anchor href=#2-download-all-packages-before-starting-to-install-any>#</a></h2><p>Installing a network (NIC, WiFi adapter) driver can cause a short loss of network connectivity. When you feed packages found by
<code>Get-LSUpdate</code> directly to <code>Install-LSUpdate</code> they will each be individually downloaded and then installed, therefore a network
driver installation can cause the following package downloads to fail (see <a href=https://github.com/jantari/LSUClient/issues/41>GitHub issue #41</a>).
Downloading all packages you intend to install beforehand with <code>Save-LSUpdate</code> will prevent this potential problem.</p><details><summary>Example</summary><div class=markdown-inner><p>This is a minimal example implementation of this best practice for demonstration purposes:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c># Find updates</span>
</span></span><span class=line><span class=cl><span class=nv>$updates</span> <span class=p>=</span> <span class=nb>Get-LSUpdate</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Download them all to the local disk</span>
</span></span><span class=line><span class=cl><span class=nv>$updates</span> <span class=p>|</span> <span class=nb>Save-LSUpdate</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Then install</span>
</span></span><span class=line><span class=cl><span class=nv>$updates</span> <span class=p>|</span> <span class=nb>Install-LSUpdate</span>
</span></span></code></pre></td></tr></table></div></div></div></details><blockquote class="book-hint info">If you download packages to a custom location with <code>Save-LSUpdate -Path</code> you have to pass that same path to <code>Install-LSUpdate -Path</code>
in order for it to find the previously downloaded files. If <code>Install-LSUpdate</code> cannot find the expected files locally, it will still
attempt to fetch them from the repository.</blockquote><h2 id=3-write-a-logfile>3. Write a logfile
<a class=anchor href=#3-write-a-logfile>#</a></h2><p>Especially when running unattended or remotely, it is crucial to have a good logfile that details what happened and allows you to find
the cause of a problem in retrospect.</p><p>If you don&rsquo;t know where to start, start with <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.host/start-transcript?view=powershell-5.1"><code>Start-Transcript</code></a> to log whatever is being output to the console.
If you would like more insight into what LSUClient is doing, add the common <code>-Verbose</code> parameter to the cmdlets you run.
If you are intimately familiar with Lenovos package XML format, perhaps even the output of <code>Get-LSUpdate -Verbose -Debug</code> will be useful to you.</p><details><summary>Example</summary><div class=markdown-inner><p>This is a minimal example implementation of this best practice for demonstration purposes:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>Start-Transcript</span> <span class=n>-LiteralPath</span> <span class=s2>&#34;$env:TEMP\lsuclient_</span><span class=p>$(</span><span class=nb>Get-Date</span> <span class=n>-Format</span> <span class=s1>&#39;yyyyMMdd-HHmmss&#39;</span><span class=p>)</span><span class=s2>.log&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$updates</span> <span class=p>=</span> <span class=nb>Get-LSUpdate</span> <span class=n>-Verbose</span>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;</span><span class=p>$(</span><span class=nv>$updates</span><span class=p>.</span><span class=n>Count</span><span class=p>)</span><span class=s2> updates found&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$i</span> <span class=p>=</span> <span class=n>1</span>
</span></span><span class=line><span class=cl><span class=k>foreach</span> <span class=p>(</span><span class=nv>$update</span> <span class=k>in</span> <span class=nv>$updates</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>Write-Host</span> <span class=s2>&#34;Installing update $i of </span><span class=p>$(</span><span class=nv>$updates</span><span class=p>.</span><span class=n>Count</span><span class=p>)</span><span class=s2>: </span><span class=p>$(</span><span class=nv>$update</span><span class=p>.</span><span class=n>Title</span><span class=p>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>Install-LSUpdate</span> <span class=n>-Package</span> <span class=nv>$update</span> <span class=n>-Verbose</span>
</span></span><span class=line><span class=cl>    <span class=nv>$i</span><span class=p>++</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Stop-Transcript</span>
</span></span></code></pre></td></tr></table></div></div></div></details></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#1-search-for-and-install-updates-a-few-times-in-a-loop>1. Search for and install updates a few times in a loop</a></li><li><a href=#2-download-all-packages-before-starting-to-install-any>2. Download all packages before starting to install any</a></li><li><a href=#3-write-a-logfile>3. Write a logfile</a></li></ul></nav></div></aside></main></body></html>