<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  Self-Hosted Repositories
  #

By default LSUClient fetches packages from the official, public Lenovo Update Catalog at https://download.lenovo.com/catalog.
However, just like System Update, it also supports custom, self-hosted package repositories.
It is currently not possible to create or manage such a custom package repository with LSUClient.
Self-hosted repositories must either be created with the &ldquo;Lenovo Update Retriever&rdquo; program or finagled in
place manually or with your own scripts if you understand the structure (see repository formats)."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://jantari.github.io/LSUClient-docs/docs/topics/self-hosted-repositories/"><meta property="og:site_name" content="LSUClient Documentation"><meta property="og:title" content="Self-Hosted Repositories"><meta property="og:description" content="Self-Hosted Repositories # By default LSUClient fetches packages from the official, public Lenovo Update Catalog at https://download.lenovo.com/catalog. However, just like System Update, it also supports custom, self-hosted package repositories.
It is currently not possible to create or manage such a custom package repository with LSUClient. Self-hosted repositories must either be created with the “Lenovo Update Retriever” program or finagled in place manually or with your own scripts if you understand the structure (see repository formats)."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><title>Self-Hosted Repositories | LSUClient Documentation</title><link rel=icon href=/LSUClient-docs/favicon.png><link rel=manifest href=/LSUClient-docs/manifest.json><link rel=canonical href=https://jantari.github.io/LSUClient-docs/docs/topics/self-hosted-repositories/><link rel=stylesheet href=/LSUClient-docs/book.min.4d4a5c4021ad6a9b1a1d87bdbeeedcca884fe4546216b266f3ec245e70016b08.css integrity="sha256-TUpcQCGtapsaHYe9vu7cyohP5FRiFrJm8+wkXnABawg=" crossorigin=anonymous><script defer src=/LSUClient-docs/fuse.min.js></script><script defer src=/LSUClient-docs/en.search.min.c02c1d3bfc0fc0ace8fb56c09f4a49e41577a896c7fb79c8eb3761e0a889cb21.js integrity="sha256-wCwdO/wPwKzo+1bAn0pJ5BV3qJbH+3nI6zdh4KiJyyE=" crossorigin=anonymous></script><link rel=stylesheet type=text/css href=/LSUClient-docs/nord.css><link rel=stylesheet type=text/css href=/LSUClient-docs/syntax.css><link rel=stylesheet type=text/css href=/LSUClient-docs/fontawesome/css/fontawesome.css><link rel=stylesheet type=text/css href=/LSUClient-docs/fontawesome/css/brands.css><link rel=stylesheet type=text/css href=/LSUClient-docs/fontawesome/css/solid.css></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/LSUClient-docs/><span>LSUClient Documentation</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li class=book-section-flat><span>Topics</span><ul><li><a href=/LSUClient-docs/docs/topics/examples/>Getting Started</a></li><li><a href=/LSUClient-docs/docs/topics/best-practices/>Best Practices</a></li><li><a href=/LSUClient-docs/docs/topics/bios-and-firmware/>BIOS/UEFI and Firmware Updates</a></li><li><a href=/LSUClient-docs/docs/topics/hanging-processes/>Troubleshooting Hanging Processes</a></li><li><a href=/LSUClient-docs/docs/topics/self-hosted-repositories/ class=active>Self-Hosted Repositories</a></li><li><a href=/LSUClient-docs/docs/topics/versioning/>Versioning</a></li></ul></li><li class=book-section-flat><span>Cmdlet Reference</span><ul><li><a href=/LSUClient-docs/docs/cmdlets/expand-lsupdate/>Expand-LSUpdate</a></li><li><a href=/LSUClient-docs/docs/cmdlets/get-lsuclientconfiguration/>Get-LSUClientConfiguration</a></li><li><a href=/LSUClient-docs/docs/cmdlets/get-lsupdate/>Get-LSUpdate</a></li><li><a href=/LSUClient-docs/docs/cmdlets/install-lsupdate/>Install-LSUpdate</a></li><li><a href=/LSUClient-docs/docs/cmdlets/save-lsupdate/>Save-LSUpdate</a></li><li><a href=/LSUClient-docs/docs/cmdlets/set-lsuclientconfiguration/>Set-LSUClientConfiguration</a></li></ul></li><li class=book-section-flat><span>Links</span><ul></ul></li></ul><ul><li><a href=https://github.com/jantari/LSUClient target=_blank rel=noopener><i class="fa-brands fa-github beat-on-hover"></i>
GitHub</a></li><li><a href=https://github.com/jantari/LSUClient/releases target=_blank rel=noopener><i class="fa-solid fa-list-ul beat-on-hover"></i>
Release Notes</a></li><li><a href=https://www.powershellgallery.com/packages/LSUClient/ target=_blank rel=noopener><i class="fa-solid fa-terminal beat-on-hover"></i>
PowerShell Gallery</a></li><li><a href=https://github.com/alex-shpak/hugo-book target=_blank rel=noopener><i class="fa-solid fa-paint-roller beat-on-hover"></i>
Hugo Book Theme</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/LSUClient-docs/svg/menu.svg class=book-icon alt=Menu></label><h3>Self-Hosted Repositories</h3><label for=toc-control><img src=/LSUClient-docs/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#repository-formats>Repository formats</a><ul><li><a href=#model-xml>Model-XML</a></li><li><a href=#database-xml>Database-XML</a></li></ul></li><li><a href=#package-finding-process>Package finding process</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=self-hosted-repositories>Self-Hosted Repositories
<a class=anchor href=#self-hosted-repositories>#</a></h1><p>By default LSUClient fetches packages from the official, public Lenovo Update Catalog at <a href=https://download.lenovo.com/catalog>https://download.lenovo.com/catalog</a>.
However, just like System Update, it also supports custom, self-hosted package repositories.</p><p>It is currently not possible to <strong>create</strong> or <strong>manage</strong> such a custom package repository with LSUClient.
Self-hosted repositories must either be created with the &ldquo;Lenovo Update Retriever&rdquo; program or finagled in
place manually or with your own scripts if you understand the structure (see <a href=#repository-formats>repository formats</a>).</p><p>Maintaining your own package repository may be of interest if you:</p><ul><li>Require offline or network-internal operation</li><li>Require total control over packages distributed</li><li>Want to hack around, manually edit package metadata or create your own packages</li></ul><blockquote class="book-hint info">If you want to run LSUClient on machines that do not have direct internet acccess, or you want to speed up package
download times as you deploy the same model of computer (and download the same packages) again and again, setting up
a caching proxy server may be a lower-maintenance alternative to a fully internal package repository.</blockquote><p>To retrieve packages from a custom package repository, use the <code>Repository</code> parameter of <code>Get-LSUpdate</code> and point it to your repository:</p><div class=book-tabs><input type=radio class=toggle name=tabs-custom-repo-1 id=tabs-custom-repo-1-0 checked>
<label for=tabs-custom-repo-1-0>Web-based repository</label><div class="book-tabs-content markdown-inner">You can serve your custom repository over HTTPS (or just plain HTTP) from a webserver as static files.
The webserver must accept GET and HEAD requests.
POST, PUT or any other methods are not required and can be disabled or blocked.
Example of retrieving packages from an internal webserver:<div><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>Get-LSUpdate</span> <span class=n>-Repository</span> <span class=s1>&#39;https://pkgs.domain.tld/lenovo-drivers&#39;</span>
</span></span></code></pre></div></div></div><input type=radio class=toggle name=tabs-custom-repo-1 id=tabs-custom-repo-1-1>
<label for=tabs-custom-repo-1-1>Filesystem-based repository</label><div class="book-tabs-content markdown-inner">You can host your custom repository via a Windows filesystem path, either local or via SMB using a network drive or UNC-path.
The user account running LSUClient must have read-access to the repository. Write or Modify access is not required.
Example of retrieving packages from an internal fileserver:<div><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>Get-LSUpdate</span> <span class=n>-Repository</span> <span class=s1>&#39;\\pkgs.domain.tld\lenovo-drivers$\&#39;</span>
</span></span></code></pre></div></div></div></div><h2 id=repository-formats>Repository formats
<a class=anchor href=#repository-formats>#</a></h2><p>A package repository is simply a file and directory structure with one of two specific, expected package index
files in the root directory that I call Model-XML and Database-XML.</p><p>LSUClient supports fetching packages from both of these types of repositories directly.</p><h3 id=model-xml>Model-XML
<a class=anchor href=#model-xml>#</a></h3><p>This is the structure the official, public Lenovo repository uses. There are many XML files directly in the
repository root, one for each computer-model and major-OS-version combination, using the name scheme
<code>{{ Lenovo Machine Type Model (MTM) Code }}_Win{{ Major Version }}.xml</code>. These XML files then each contain
a list of links to individual packages relevant for that system.</p><blockquote class="book-hint info">I know of no automatic or official method to create a custom repository of this structure. The easiest way would be to download the XML files off of the public repository with a script and editing the "location" of each package to point to an internal or relative path instead of the public downloads.lenovo.com site.</blockquote><p>For example <a href=https://download.lenovo.com/catalog/20ls_win10.xml>this</a> is the &ldquo;Model-XML&rdquo; file
for a Lenovo ThinkPad L480 (Type 20LS) running Windows 10.</p><h3 id=database-xml>Database-XML
<a class=anchor href=#database-xml>#</a></h3><p>This is the repository structure that Update Retriever creates. It uses a single file named <code>database.xml</code> in the repository root that contains a list of all packages in the repository and the information which computer-and-OS combinations each one is for.</p><blockquote class="book-hint warning">The `database.xml` package index does not preserve package Category information. This means that all packages sourced from repositories of this type will always have empty Categories.</blockquote><blockquote class="book-hint info">You can also create and manage a repository with Update Retriever and then serve it (its root directory) via HTTP(S).</blockquote><h2 id=package-finding-process>Package finding process
<a class=anchor href=#package-finding-process>#</a></h2><p>Assuming a ThinkPad A275, model <strong>20KD</strong>001LGE, running Windows 10 as an example,
LSUClients process for discovering packages in a repository is as follows:</p><script src=/LSUClient-docs/mermaid.min.js></script><script>mermaid.initialize({flowchart:{useMaxWidth:!0},theme:"default"})</script><pre class=mermaid>
%%{init:{"theme":"neutral"}}%%
flowchart TD;
    Start([Start]) --> B{"Does 20KD_Win10.xml exist\nin the repository root?"}
    B --> |No| C{"Does database.xml exist\nin the repository root?"}
    C --> |No| F([Error: No packages found])
    C --> |Yes| OK[Read it and find packages]
    B --> |Yes| H
    OK -->G{Are there packages for\nmodel 20KD + Windows 10?}
    G -->|No| F
    G -->|Yes| H[Process packages]
</pre><p>This means that when both a <code>database.xml</code> file and model-and-OS-specific XML files are present in a repository,
LSUClient will look for and use the Model-XML file first and then fall back to <code>database.xml</code> only when none was found.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#repository-formats>Repository formats</a><ul><li><a href=#model-xml>Model-XML</a></li><li><a href=#database-xml>Database-XML</a></li></ul></li><li><a href=#package-finding-process>Package finding process</a></li></ul></nav></div></aside></main></body></html>